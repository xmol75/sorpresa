<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operación Chuletón</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Special+Elite&family=Bangers&family=Roboto:wght@400;700&display=swap');

        :root {
            --color-fondo: #111827;
            --color-panel: #1F2937;
            --color-borde: #FBBF24;
            --color-texto: #E5E7EB;
            --color-titulo: #FBBF24;
            --color-exito: #34D399;
            --color-error: #F87171;
        }

        body {
            background-color: var(--color-fondo);
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--color-texto);
            text-align: center;
        }

        .contenedor-mision {
            background-color: var(--color-panel);
            border: 2px solid var(--color-borde);
            border-radius: 15px;
            padding: clamp(1rem, 5vw, 2.5rem);
            width: 100%;
            max-width: 800px;
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.2);
            display: none;
            flex-direction: column;
            align-items: center;
            animation: aparecer 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        .contenedor-mision.activo {
            display: flex;
        }

        @keyframes aparecer {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        h1, h2 {
            font-family: 'Bangers', cursive;
            color: var(--color-titulo);
            text-shadow: 2px 2px 0px #000;
            margin: 0 0 15px 0;
            letter-spacing: 1px;
        }

        h1 { font-size: clamp(2rem, 8vw, 3.5rem); }
        h2 { font-size: clamp(1.5rem, 6vw, 2.5rem); }

        p {
            font-family: 'Special Elite', monospace;
            font-size: clamp(1rem, 3vw, 1.2rem);
            line-height: 1.8;
            max-width: 600px;
        }

        .boton-mision {
            font-family: 'Bangers', cursive;
            font-size: 1.5rem;
            padding: 12px 35px;
            margin-top: 25px;
            border: none;
            border-radius: 10px;
            background: var(--color-borde);
            color: #111827;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4);
        }

        .boton-mision:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.5);
            filter: brightness(1.1);
        }
        
        .opciones-respuesta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .boton-opcion {
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            padding: 15px 20px;
            border: 2px solid var(--color-borde);
            border-radius: 10px;
            background-color: transparent;
            color: var(--color-borde);
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 200px;
        }
        
        .boton-opcion:hover {
            background-color: var(--color-borde);
            color: var(--color-panel);
        }
        
        .opciones-respuesta-img {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .opciones-respuesta-img img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 10px;
            border: 3px solid var(--color-borde);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            background-color: #333;
        }
        .opciones-respuesta-img img:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--color-borde);
        }

        .campo-respuesta {
            font-family: 'Special Elite', monospace;
            background-color: var(--color-texto);
            color: var(--color-fondo);
            border: 2px solid var(--color-borde);
            border-radius: 5px;
            font-size: 1.5rem;
            text-align: center;
            padding: 10px;
            margin-top: 20px;
            width: 80%;
            max-width: 300px;
            text-transform: uppercase;
        }

        .imagen-pista {
            max-width: 90%;
            width: 400px;
            border-radius: 15px;
            border: 5px solid var(--color-borde);
            margin: 20px 0;
            background-color: #333;
        }
        
        #boveda-display {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }
        .letra-display {
            width: 45px;
            height: 55px;
            background-color: #111827;
            border: 2px solid var(--color-borde);
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Bangers', cursive;
            font-size: 2.2rem;
            color: var(--color-exito);
        }
        
        #boveda-controles {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        #boveda-controles button {
            font-family: 'Bangers';
            width: 50px;
            height: 50px;
            font-size: 1.8rem;
            border-radius: 50%;
            border: none;
            background-color: var(--color-borde);
            color: var(--color-fondo);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #paso-final .logo-final {
            max-width: 80%;
            max-height: 150px;
            margin-bottom: 20px;
        }
        
        #paso-final .galeria-final {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        #paso-final .galeria-final img {
            width: 100%;
            max-width: 220px;
            border-radius: 10px;
            border: 2px solid var(--color-borde);
            background-color: #333;
        }
        
        #paso-final h1 { color: var(--color-exito); }
        #paso-final p strong { color: var(--color-borde); font-family: 'Bangers'; font-size: 1.5em; }

        .mensaje-feedback {
            font-family: 'Special Elite', monospace;
            margin-top: 15px;
            height: 25px;
            font-size: 1.1rem;
            font-weight: bold;
        }
        .error { color: var(--color-error); }
        .exito { color: var(--color-exito); }

        .confeti-contenedor { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
        .confeti { position: absolute; width: 10px; height: 10px; background-color: #f00; opacity: 0; animation: caer 5s linear forwards; border-radius: 50%; }
        @keyframes caer { 0% { transform: translateY(-100px); opacity: 1; } 100% { transform: translateY(110vh); opacity: 0; } }
    </style>
</head>
<body>

    <div class="confeti-contenedor" id="confeti-contenedor"></div>

    <!-- PASO 1: INTRODUCCIÓN -->
    <div class="contenedor-mision activo" id="paso-1">
        <h1>Operación Cultural</h1>
        <p>Agentes, hemos detectado una oportunidad única para una misión de enriquecimiento cultural intensivo. El objetivo es un tesoro nacional. Para localizarlo, debéis superar una serie de pruebas de conocimiento. ¿Aceptáis el desafío?</p>
        <button class="boton-mision" onclick="avanzarPaso(2)">Aceptar Misión</button>
    </div>

    <!-- PASO 2: CATEDRAL DE LEÓN -->
    <div class="contenedor-mision" id="paso-2">
        <h2>Nivel 1: La Joya Gótica</h2>
        <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/catedral.jpeg" class="imagen-pista" alt="Catedral de León">
        <p>Nuestra primera parada es León. Su catedral es una obra maestra del gótico. ¿Con qué apodo se la conoce popularmente por sus 1.800 metros cuadrados de impresionantes vidrieras?</p>
        <div class="opciones-respuesta">
            <button class="boton-opcion" onclick="mostrarFeedback(2, 'INCORRECTO. ESA ES OTRA GRAN OBRA.')">La Dama de Piedra</button>
            <button class="boton-opcion" onclick="verificarRespuesta(2, 'PULCHRA LEONINA')">La Pulchra Leonina</button>
            <button class="boton-opcion" onclick="mostrarFeedback(2, 'NEGATIVO. INTENTA DE NUEVO.')">La Casa de Luz</button>
        </div>
        <p class="mensaje-feedback" id="feedback-2"></p>
    </div>
    
    <!-- PASO 3: PALACIO DE ASTORGA -->
    <div class="contenedor-mision" id="paso-3">
        <h2>Nivel 2: El Genio Modernista</h2>
        <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/episcopal.jpg" class="imagen-pista" alt="Palacio Episcopal de Astorga">
        <p>Nos desviamos a Astorga. Este edificio parece un castillo de cuento de hadas y fue diseñado por un arquitecto catalán universalmente famoso. ¿Quién fue el genio detrás de esta obra?</p>
        <div class="opciones-respuesta">
            <button class="boton-opcion" onclick="mostrarFeedback(3, 'ERROR. ESE ARQUITECTO ES MÁS RECIENTE.')">Santiago Calatrava</button>
            <button class="boton-opcion" onclick="verificarRespuesta(3, 'GAUDI')">Antoni Gaudí</button>
            <button class="boton-opcion" onclick="mostrarFeedback(3, 'PISTA FALSA. SIGUE BUSCANDO.')">Juan de Villanueva</button>
        </div>
        <p class="mensaje-feedback" id="feedback-3"></p>
    </div>

    <!-- PASO 4: ESTATUS DE CATEDRAL -->
    <div class="contenedor-mision" id="paso-4">
        <h2>Nivel 3: Rango Eclesiástico</h2>
        <p>Información clave: tanto León como Astorga tienen catedrales. Para que una iglesia reciba el estatus de 'Catedral', debe ser la sede de una de estas figuras. ¡Selecciona la correcta!</p>
        <div class="opciones-respuesta-img">
            <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/papa.jpg" alt="Opción Papa" onclick="mostrarFeedback(4, 'INCORRECTO. ESA FIGURA RESIDE EN EL VATICANO.')">
            <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/cardenal.jpg" alt="Opción Cardenal" onclick="mostrarFeedback(4, 'NEGATIVO. TIENEN OTRO RANGO.')">
            <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/obispo.jpg" alt="Opción Obispo" onclick="verificarRespuesta(4, 'OBISPO')">
        </div>
        <p class="mensaje-feedback" id="feedback-4"></p>
    </div>

    <!-- PASO 5: EL ANIMAL -->
    <div class="contenedor-mision" id="paso-5">
        <h2>Nivel 4: La Fuerza de la Tierra</h2>
        <p>¡Excelente! La misión se vuelve gastronómica. En León, se venera la carne de un animal rumiante, grande y fuerte, famoso por su sabor excepcional. No es un toro. ¿Qué animal es?</p>
        <input type="text" id="respuesta-paso-5" class="campo-respuesta" placeholder="Escribe aquí..." autocomplete="off">
        <button class="boton-mision" onclick="verificarRespuesta(5, 'BUEY')">Comprobar</button>
        <p class="mensaje-feedback" id="feedback-5"></p>
    </div>
    
    <!-- PASO 6: BÓVEDA / RESTAURANTE -->
    <div class="contenedor-mision" id="paso-6">
        <h2>Nivel Final: La Bóveda Secreta</h2>
        <p>Estáis a un paso. Hay un restaurante en un pueblo de León que es una leyenda mundial. La contraseña de la bóveda es su nombre, un auténtico... (8 letras)</p>
        <div id="boveda-display"></div>
        <div id="boveda-controles">
            <button id="prev-letra">&uarr;</button>
            <button id="next-letra">&darr;</button>
        </div>
        <button class="boton-mision" onclick="verificarBoveda()">Abrir Bóveda</button>
        <p class="mensaje-feedback" id="feedback-6"></p>
    </div>

    <!-- PASO FINAL: SORPRESA -->
    <div class="contenedor-mision" id="paso-final">
        <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/logo.png" alt="Logo El Capricho" class="logo-final">
        <h1>¡¡MISIÓN COMPLETADA!!</h1>
        <p>Vuestra próxima misión es un...<br><strong>¡VIAJE SORPRESA A LEÓN!</strong><br>Con cena el día <strong>29 de Julio</strong> en el templo de la carne...</p>
        <div class="galeria-final">
            <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/buey.jpg" alt="Buey de El Capricho">
            <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/carne.jpg" alt="Carne de El Capricho">
            <img src="https://raw.githubusercontent.com/xmol75/sorpresa/main/mesas.jpeg" alt="Mesas de El Capricho">
        </div>
    </div>

    <script>
        let pasoActual = 1;

        function avanzarPaso(numeroPaso) {
            const pasoActivo = document.querySelector('.contenedor-mision.activo');
            if (pasoActivo) {
                pasoActivo.classList.remove('activo');
            }
            const siguientePaso = document.getElementById(`paso-${numeroPaso}`);
            if (siguientePaso) {
                siguientePaso.classList.add('activo');
            }
            pasoActual = numeroPaso;
        }

        function mostrarFeedback(paso, mensaje, esError = true) {
            const feedbackEl = document.getElementById(`feedback-${paso}`);
            feedbackEl.textContent = mensaje;
            feedbackEl.className = 'mensaje-feedback ' + (esError ? 'error' : 'exito');
            if (esError) {
                setTimeout(() => { feedbackEl.textContent = ''; }, 2500);
            }
        }

        function verificarRespuesta(paso, respuestaCorrecta) {
            let esCorrecto = false;
            if (paso === 2 || paso === 3 || paso === 4) { // Pasos con botones o imágenes
                esCorrecto = true;
            } else { // Pasos con campo de texto
                const input = document.getElementById(`respuesta-paso-${paso}`);
                const respuestaUsuario = input.value.toUpperCase().trim();
                esCorrecto = (respuestaUsuario === respuestaCorrecta);
            }

            if (esCorrecto) {
                mostrarFeedback(paso, 'RESPUESTA CORRECTA. TRANSMITIENDO DATOS...', false);
                setTimeout(() => {
                    avanzarPaso(paso + 1);
                }, 1500);
            } else {
                mostrarFeedback(paso, 'ACCESO DENEGADO. INTÉNTALO DE NUEVO.');
                const input = document.getElementById(`respuesta-paso-${paso}`);
                if (input) input.value = '';
            }
        }

        // --- Lógica de la Bóveda (Paso 6) ---
        const codigoBoveda = "CAPRICHO";
        const alfabeto = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        let estadoBoveda = Array(codigoBoveda.length).fill(0);
        let letraActiva = 0;
        const bovedaDisplay = document.getElementById('boveda-display');

        function inicializarBoveda() {
            bovedaDisplay.innerHTML = '';
            for (let i = 0; i < codigoBoveda.length; i++) {
                const letraDiv = document.createElement('div');
                letraDiv.className = 'letra-display';
                letraDiv.id = `letra-${i}`;
                letraDiv.textContent = alfabeto[0];
                letraDiv.dataset.index = i;
                bovedaDisplay.appendChild(letraDiv);
            }
            actualizarFocoLetra();
        }

        function actualizarFocoLetra() {
            document.querySelectorAll('.letra-display').forEach((el, idx) => {
                el.style.borderColor = (idx === letraActiva) ? 'white' : 'var(--color-borde)';
                el.style.boxShadow = (idx === letraActiva) ? '0 0 15px white' : 'none';
            });
        }
        
        function cambiarLetra(direccion) {
            estadoBoveda[letraActiva] = (estadoBoveda[letraActiva] + direccion + alfabeto.length) % alfabeto.length;
            document.getElementById(`letra-${letraActiva}`).textContent = alfabeto[estadoBoveda[letraActiva]];
        }
        
        document.getElementById('prev-letra').onclick = () => cambiarLetra(-1);
        document.getElementById('next-letra').onclick = () => cambiarLetra(1);
        
        bovedaDisplay.addEventListener('click', (e) => {
            if (e.target.classList.contains('letra-display') && e.target.dataset.index) {
                letraActiva = parseInt(e.target.dataset.index);
                actualizarFocoLetra();
            }
        });

        function verificarBoveda() {
            const intento = estadoBoveda.map(i => alfabeto[i]).join('');
            if (intento === codigoBoveda) {
                mostrarFeedback(6, 'BÓVEDA ABIERTA. REVELANDO OBJETIVO...', false);
                setTimeout(() => {
                    avanzarPaso('final');
                    lanzarConfeti();
                }, 1500);
            } else {
                mostrarFeedback(6, 'CONTRASEÑA INCORRECTA. SISTEMA DE SEGURIDAD ACTIVADO.');
            }
        }

        // --- Confeti ---
        function lanzarConfeti() {
            const contenedor = document.getElementById('confeti-contenedor');
            const colores = ['#FBBF24', '#F87171', '#34D399', '#60A5FA', '#E5E7EB'];
            for (let i = 0; i < 200; i++) {
                const confeti = document.createElement('div');
                confeti.classList.add('confeti');
                confeti.style.left = Math.random() * 100 + 'vw';
                confeti.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
                confeti.style.animationDelay = Math.random() * 2 + 's';
                confeti.style.transform = `scale(${Math.random() * 1.2 + 0.5})`;
                contenedor.appendChild(confeti);
            }
        }
        
        inicializarBoveda();
    </script>
</body>
</html>
